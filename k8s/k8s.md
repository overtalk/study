# Kubenetes

## k8s物理结构
- 由多个物理主机（可以是虚拟机）构成集群，将多个底层物理主机的资源抽象出来组成一个平台进行编排管理
- 集群中所有的节点分成两类 : Master 和 Node，所有的容器中的应用程序都是运行在node中,而master是负责管理有多少个节点、每个节点上应该运行哪个或哪些容器的统一的控制中心。因此master被称为control plane（控制平面），node称为worker
- 多台master是为了冗余，避免但宕机，而不是用于负载均衡。而多个node就是为了负载均衡
- 支持多个容器引擎（docker...）,最好是docker，其他的容器引擎使用cri进行交互

## k8s master的组成
- 四个逻辑组件组成，每个组件都需要运行一个守护进程。
- API Server : 接受客户端请求的入口，检测语法规则，再存储在etcd中，controller watch API Server，有新任务时候由controller执行
- Scheduler : 调度器，监控集群所有节点的运算资源（cpu）和内存资源，根据资源情况分配给每个节点任务
- Controller : 控制器，执行用户命令，监控容器的存活情况，类似与大脑
- etcd (非k8s自己提供) : k-v存储系统，存储容器状态

## k8s node的组成
- 每一个节点上有一个kublet进程，负责watch API Server，当分配给自己这个节点新的容器任务/容器状态变化时，就会调用Docker
- k8s虽然是容器编排系统，但是每个运行的容器，再k8s上都是进行重新封装过的，叫做pod，既k8s不会直接运行容器，而是运行pod，pod是容器的一层外壳。一个pod中可能存在多个容器，这多个容器当成一个原子来进行管理的。（既这些个容器都都只能运行在同一台节点之上），k8s运行的核心基本单元是pod，而不是容器。

## pod
- k8s运行的原子单元并非是容器，而是pod组件